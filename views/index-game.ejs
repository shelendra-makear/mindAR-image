<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Face Tracking — Stable Version (MediaPipe FaceMesh)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- ⭐ MediaPipe FaceMesh -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
  body { background:#000; color:#fff; text-align:center; font-family:Arial; }
  #faceCam {
    visibility: hidden;
    position: fixed;
    top:-9999px;
    left:-9999px;
    width:320px;
    height:240px;
    transform: scaleX(-1);
  }
</style>
</head>
<body>

<h2>Face Tracking — Working Stable Version</h2>
<p id="status">Loading...</p>

<video id="faceCam" autoplay playsinline muted></video>

<script>
const statusEl = document.getElementById("status");
const videoEl = document.getElementById("faceCam");

statusEl.innerText = "Loading FaceMesh…";

// ⭐ Create FaceMesh instance
const faceMesh = new FaceMesh({
  locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`
});

faceMesh.setOptions({
  maxNumFaces: 1,
  refineLandmarks: true,
  minDetectionConfidence: 0.5,
  minTrackingConfidence: 0.5
});

// ⭐ CALLBACK: FACE DETECTED
faceMesh.onResults(results => {
  if (!results.multiFaceLandmarks || results.multiFaceLandmarks.length === 0) {
    statusEl.innerText = "No face";
    return;
  }

  const face = results.multiFaceLandmarks[0];
  const nose = face[1]; // nose landmark

  const nx = nose.x; // normalized left→right 0–1
  const ny = nose.y; // normalized top→bottom 0–1

  let dir = "";

  if (nx < 0.35) dir = "LEFT";
  else if (nx > 0.65) dir = "RIGHT";
  else dir = "CENTER";

  if (ny < 0.35) dir = "UP";
  if (ny > 0.65) dir = "DOWN";

  statusEl.innerText = "Direction: " + dir;
});

// ⭐ START CAMERA (Works on Samsung)
const camera = new Camera(videoEl, {
  onFrame: async () => {
    await faceMesh.send({ image: videoEl });
  },
  width: 320, height: 240
});

camera.start().then(() => {
  statusEl.innerText = "Camera Started ✓";
}).catch(err => {
  statusEl.innerText = "Camera error: " + err;
});
</script>

</body>
</html>
